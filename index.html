<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Scraper Blog Sakurazaka46</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #output { width: 100%; height: 400px; overflow: auto; border: 1px solid #ccc; padding: 10px; white-space: pre-wrap; background: #f9f9f9; }
    button { margin-bottom: 10px; }
</style>
</head>
<body>

<h2>Scraper Blog Sakurazaka46</h2>
<button id="copyBtn">Copy Output</button>
<div id="output">Loading...</div>

<script>
const API_KEY = "AIzaSyD9HGZ6pIVouEgiaTS_dFnVod-kafD0RWk"; // Gemini API Key

async function translateText(text) {
    // Panggilan AI Gemini API untuk romaji + terjemahan
    const prompt = `Ubah teks Jepang berikut menjadi 2 baris: 
1. Romaji (kana + kanji)
2. Terjemahan Indonesia
Teks: ${text}`;
    
    const response = await fetch("https://gemini.googleapis.com/v1/models/text-bison-001:predict", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${API_KEY}`
        },
        body: JSON.stringify({
            "instances": [{"content": prompt}]
        })
    });
    const data = await response.json();
    // Ambil teks AI
    return data.predictions?.[0]?.content || "";
}

function fixImageLinks(html) {
    // Tambah prefix untuk gambar yang relatif
    return html.replace(/<img\s+[^>]*src="(?!https?:\/\/)([^"]+)"/g, '<img src="https://sakurazaka46.com/$1"');
}

async function scrapeAndTranslate() {
    const output = $("#output");
    output.text("Loading...");
    
    // Ambil semua box-article
    const articles = $(".box-article");
    let result = "";

    for (let i = 0; i < articles.length; i++) {
        const htmlContent = fixImageLinks(articles[i].innerHTML);
        
        // Ambil teks Jepang asli saja
        const jpText = $(articles[i]).text().trim();

        // Panggil AI untuk romaji + terjemahan
        const aiResult = await translateText(jpText);

        // Gabungkan full HTML + AI result
        const combined = `
${htmlContent}
${aiResult}
---------------------------
`;
        result += combined;
    }

    output.text(result);
}

// Tombol copy
$("#copyBtn").click(() => {
    const text = $("#output").text();
    navigator.clipboard.writeText(text).then(() => alert("Copied!"));
});

// Jalankan scrape
$(document).ready(scrapeAndTranslate);
</script>
</body>
</html>
